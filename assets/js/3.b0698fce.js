(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{348:function(t,e,r){t.exports=r.p+"assets/img/connectivity.57abc741.png"},349:function(t,e,r){t.exports=r.p+"assets/img/0-ip-address-client.204d0b31.png"},350:function(t,e,r){t.exports=r.p+"assets/img/1st_screen.e93c62cb.png"},351:function(t,e,r){t.exports=r.p+"assets/img/2nd_screen_cn.39f86a7b.png"},352:function(t,e,r){t.exports=r.p+"assets/img/2nd_screen_en.55494f81.png"},353:function(t,e,r){t.exports=r.p+"assets/img/3rd_screen_cn.3d80b558.png"},354:function(t,e,r){t.exports=r.p+"assets/img/3rd_screen_en.454dc84d.png"},355:function(t,e,r){t.exports=r.p+"assets/img/4th_screen_cn.4652126a.png"},356:function(t,e,r){t.exports=r.p+"assets/img/5th-screen-cn.5ba86da9.png"},357:function(t,e,r){t.exports=r.p+"assets/img/5th-screen-en.96f0245d.png"},358:function(t,e,r){t.exports=r.p+"assets/img/6th-screen-en.b8ffca53.png"},359:function(t,e,r){t.exports=r.p+"assets/img/6th-screen-cn.df405b60.png"},360:function(t,e,r){t.exports=r.p+"assets/img/7th_screen_cn.02268df8.png"},361:function(t,e,r){t.exports=r.p+"assets/img/7th_screen_en.49f6e484.png"},362:function(t,e,r){t.exports=r.p+"assets/img/81-open_app.d4dd6583.png"},363:function(t,e,r){t.exports=r.p+"assets/img/82-sign-in-app.1582f056.png"},364:function(t,e,r){t.exports=r.p+"assets/img/80-select-phone-wifi.d0d40864.png"},365:function(t,e,r){t.exports=r.p+"assets/img/83-Screenshot_20180408-112951.b61ded38.png"},366:function(t,e,r){t.exports=r.p+"assets/img/84-Screenshot_20180408-113005.fbe6964e.png"},367:function(t,e,r){t.exports=r.p+"assets/img/85-Screenshot_20180408-113011.9303dd54.png"},368:function(t,e,r){t.exports=r.p+"assets/img/get_ssh_en.cd9faf85.png"},369:function(t,e,r){t.exports=r.p+"assets/img/get_ssh_cn.b5a7d860.png"},374:function(t,e,r){"use strict";r.r(e);var s=r(42),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"openwrt-on-xiaomi-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#openwrt-on-xiaomi-router"}},[t._v("#")]),t._v(" OpenWRT on Xiaomi Router")]),t._v(" "),s("h2",{attrs:{id:"introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),s("p",[t._v("Detailed write-up including screen-shots and -grabs based on descriptions from "),s("a",{attrs:{href:"https://forum.lede-project.org/u/dissent1",target:"_blank",rel:"noopener noreferrer"}},[t._v("@dissent"),s("OutboundLink")],1),t._v(" and the "),s("a",{attrs:{href:"https://wiki.openwrt.org/toh/xiaomi/mir3g",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenWrt wiki"),s("OutboundLink")],1),t._v(" page for this router.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Disclaimer")]),t._v(" "),s("p",[t._v("Although the name might imply, this router does not have 3G - or any other 3GPP  standardized - radio")])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("Known Issues in OpenWRT 18.06")]),t._v(" "),s("p",[t._v("The release notes of 18.06 mention as known issue "),s("code",[t._v("Devices using the mt76 wireless driver may experience stability issues on 2.4GHz")]),t._v(" which might affect this device.")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Snapshots in July 2020")]),t._v(" "),s("p",[t._v("The guide is updated to link to the latest OpenWRT development snapshot images. The included uplift to Linux kernel 5.4 has subjectively create a more stable 2.4 GHz WiFi experience on this specific device.")])]),t._v(" "),s("h3",{attrs:{id:"naming"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#naming"}},[t._v("#")]),t._v(" Naming")]),t._v(" "),s("p",[t._v("The device's literal name translated from Chinese is "),s("em",[t._v("Xiaomi Router 3G")]),t._v(", with "),s("em",[t._v("Xiaomi")]),t._v(" being the company's name. There might have been earlier intentions to brand the WiFi router product line as "),s("em",[t._v("MiWiFi")]),t._v(" which would explain why Xiaomi is distributing information and firmware updates at "),s("a",{attrs:{href:"miwifi.com"}},[t._v("miwifi.com")]),t._v(".")]),t._v(" "),s("p",[t._v("OpenWrt/LEDE Project label the router's "),s("a",{attrs:{href:"https://wiki.openwrt.org/toh/xiaomi/mir3g",target:"_blank",rel:"noopener noreferrer"}},[t._v("wiki page"),s("OutboundLink")],1),t._v(" with "),s("em",[t._v("Xiaomi Mi WiFi R3G (Mi Wifi Router 3G / MIR3G / MI3G)")]),t._v(" and the openwrt software uses the profile name "),s("code",[t._v("mir3g")]),t._v(".")]),t._v(" "),s("p",[t._v("Recently Xiaomi has started to distribute one of their router products also in India, where a genuine "),s("a",{attrs:{href:"http://www.mi.com/in/mi-router-3c/",target:"_blank",rel:"noopener noreferrer"}},[t._v("English language page"),s("OutboundLink")],1),t._v(" calls the specific product Mi Router 3C. Based on that it can be assumed Xiaomi's intention is to use "),s("em",[t._v("Mi Router")]),t._v(" as the international name for the product line, which will be used throughout this document.")]),t._v(" "),s("h2",{attrs:{id:"preparations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#preparations"}},[t._v("#")]),t._v(" Preparations")]),t._v(" "),s("h3",{attrs:{id:"xiaomi-account"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xiaomi-account"}},[t._v("#")]),t._v(" Xiaomi Account")]),t._v(" "),s("p",[t._v("Create a Xiaomi account "),s("a",{attrs:{href:"http://account.xiaomi.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(" - this account is required to get the ssh binary and the serial number specific root password")]),t._v(" "),s("h3",{attrs:{id:"cable-up-for-maximum-convenience"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cable-up-for-maximum-convenience"}},[t._v("#")]),t._v(" Cable up for maximum convenience")]),t._v(" "),s("p",[t._v("The web interface of Mi Router 3G is only available in Chinese. It can be translated by Chrome's inline translation function. To facilitate this the computer running browser needs to stay connected to the internet. To achieve that the router can be connected with Ethernet to that same machine.\n"),s("img",{attrs:{src:r(348),alt:""}})]),t._v(" "),s("p",[t._v("On the interface connecting the router:")]),t._v(" "),s("ul",[s("li",[t._v("disable DHCP")]),t._v(" "),s("li",[t._v("configure static addresse between 192.168.31.2 - 192.168.31.254")]),t._v(" "),s("li",[t._v("configure netmask 255.255.255.0")]),t._v(" "),s("li",[t._v("no default gateway")])]),t._v(" "),s("img",{attrs:{src:r(349),width:"400"}}),t._v(" "),s("h2",{attrs:{id:"main-process"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-process"}},[t._v("#")]),t._v(" Main Process")]),t._v(" "),s("h3",{attrs:{id:"flash-developer-firmware-on-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flash-developer-firmware-on-router"}},[t._v("#")]),t._v(" Flash Developer Firmware on Router")]),t._v(" "),s("p",[t._v("Put the developer firmware for Mi Router 3G from here "),s("a",{attrs:{href:"http://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_c2175_2.25.122.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("miwifi_r3g_firmware_c2175_2.25.122.bin"),s("OutboundLink")],1),t._v(" on a FAT formatted USB flash drive and rename to "),s("code",[t._v("miwifi.bin")]),t._v(".")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("MiWiFi CDN")]),t._v(" "),s("p",[t._v("As of July 2020, th above link fails to download, because Xiaomi have migrated to a new CDN provider, the old firmware files got migrated but no redirects were setup. This "),s("a",{attrs:{href:"http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_c2175_2.25.122.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("link"),s("OutboundLink")],1),t._v(" should yield the sought after firmware.")])]),t._v(" "),s("p",[t._v("Plug USB flash drive into router, hold the reset button pressed, and power the router up.")]),t._v(" "),s("p",[t._v("When the yellow LED starts blinking, the flashing process has started and the reset button can be released.")]),t._v(" "),s("p",[t._v("Once the router has finished flashing and has rebooted, indicated by the LED being constant blue, the setup wizard can be reached at "),s("a",{attrs:{href:"http://192.168.1.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("192.168.31.1"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"router-setup-wizard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#router-setup-wizard"}},[t._v("#")]),t._v(" Router Setup Wizard")]),t._v(" "),s("img",{attrs:{alt:"Initial Splash Screen",src:r(350),width:"400"}}),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(351),alt:"Opt-out from user-experience and continue"}})]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(352),alt:"Opt-out from user-experience and continue"}})])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(353),alt:""}})]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(354),alt:""}})])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(355),alt:""}})]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(356),alt:""}})]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(357),alt:""}})])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(358),alt:""}})]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(359),alt:""}})])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(360),alt:""}})]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(361),alt:""}})])])])]),t._v(" "),s("h3",{attrs:{id:"pairing-router-with-xiaomi-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pairing-router-with-xiaomi-service"}},[t._v("#")]),t._v(" Pairing Router with Xiaomi Service")]),t._v(" "),s("p",[t._v("This step is run on an Android or iOS device.")]),t._v(" "),s("p",[t._v("Install the Mi WiFi app for "),s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.xiaomi.router&hl=en",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Play Store for Android"),s("OutboundLink")],1),t._v(" or for "),s("a",{attrs:{href:"https://itunes.apple.com/us/app/mi-wi-fi/id859962702?mt=8",target:"_blank",rel:"noopener noreferrer"}},[t._v("iOS from Apples's App store"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Start Up Mi WiFi app and login with the Xiaomi account created earlier:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(362),alt:""}})]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(363),alt:""}})])])]),t._v(" "),s("tbody")]),t._v(" "),s("p",[t._v("Connect to the just created WiFi network on the router through the system preferences of the mobile phone:")]),t._v(" "),s("img",{attrs:{src:r(364),width:"400"}}),t._v(" "),s("p",[t._v("After successfully connecting to the new WiFi network return to the Mi WiFi app and finish the pairing process. During the pairing enter the admin password of the router - which should be the same as the WiFi password.")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(365),alt:""}})]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(366),alt:""}})]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:r(367),alt:""}})])])]),t._v(" "),s("tbody")]),t._v(" "),s("p",[t._v("Now the router is paired and connected to the Xiaomi account.")]),t._v(" "),s("h3",{attrs:{id:"get-root-password-for-your-router-and-install-ssh"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-root-password-for-your-router-and-install-ssh"}},[t._v("#")]),t._v(" Get root password for your router and install SSH")]),t._v(" "),s("p",[t._v("Navigate to "),s("a",{attrs:{href:"https://d.miwifi.com/rom/ssh",target:"_blank",rel:"noopener noreferrer"}},[t._v("Xiaomi MiWiFi support site"),s("OutboundLink")],1),t._v(" and login with your Xiaomi account.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("In every step the server will rewrite the URL back to '''http://....''' and fail to load the page. Edit the URL in the location bar to read '''https://...'''")])]),t._v(" "),s("p",[s("img",{attrs:{src:r(368),alt:""}}),t._v(" "),s("img",{attrs:{src:r(369),alt:""}})]),t._v(" "),s("p",[t._v("Click the button to the right and download the ssh installation package "),s("code",[t._v("miwifi_ssh.bin")]),t._v(".")]),t._v(" "),s("p",[t._v("Download the OpenWrt firmware files (updated links on 20200725 to latest stable release - did not try fresh install procedure with this specific version of OpenWRT)")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://downloads.openwrt.org/releases/19.07.3/targets/ramips/mt7621/openwrt-19.07.3-ramips-mt7621-xiaomi_mir3g-squashfs-kernel1.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/releases/19.07.3/targets/ramips/mt7621/openwrt-19.07.3-ramips-mt7621-xiaomi_mir3g-squashfs-kernel1.bin"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://downloads.openwrt.org/releases/19.07.3/targets/ramips/mt7621/openwrt-19.07.3-ramips-mt7621-xiaomi_mir3g-squashfs-rootfs0.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/releases/19.07.3/targets/ramips/mt7621/openwrt-19.07.3-ramips-mt7621-xiaomi_mir3g-squashfs-rootfs0.bin"),s("OutboundLink")],1)])])]),t._v(" "),s("p",[t._v("Snapshot Download - As of this writing in July 2020, the OpenWRT development snapshots for this device include Linux kernel 5.4 which subjectively have increased the stability of the 2.4 GHz WiFi experience so these are provided as an "),s("em",[t._v("alternative")]),t._v(" to the above stable release. Do not mix files between stable and snapshot.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Might brick device")]),t._v(" "),s("p",[t._v("As always with development snapshots that are generated nighly, there is the risk that this specific one might brick your device or be unstable in any other way. If you do not understand what exactly you are doing please read up in the OpenWRT documentation about snapshots and stability. Installing snapshots might not be for you.")])]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-xiaomi_mir3g-squashfs-kernel1.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-xiaomi_mir3g-squashfs-kernel1.bin"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-xiaomi_mir3g-squashfs-rootfs0.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-xiaomi_mir3g-squashfs-rootfs0.bin"),s("OutboundLink")],1)])])]),t._v(" "),s("p",[t._v("Place "),s("code",[t._v("miwifi_ssh.bin")]),t._v(", "),s("code",[t._v("kernel1.bin")]),t._v(" and "),s("code",[t._v("rootfs0.bin")]),t._v(" on the FAT formatted USB flash drive after removing the developer firmware installation file, i.e. the "),s("code",[t._v("miwifi.bin")]),t._v(" from earlier.")]),t._v(" "),s("p",[t._v("Plug the USB flash drive into the router, hold the reset button pressed, and power the router up.")]),t._v(" "),s("p",[t._v("When the yellow LED starts blinking, the flashing process has started and the reset button can be released. This will install  and ssh daemon to allow remote access through ssh.")]),t._v(" "),s("p",[t._v("The router will reboot after installing the ssh package. Once back up the LED will turn into solid blue.")]),t._v(" "),s("h3",{attrs:{id:"install-openwrt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-openwrt"}},[t._v("#")]),t._v(" Install OpenWrt")]),t._v(" "),s("p",[t._v("From a terminal connect to the router with SSH:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ssh -l root 192.168.31.1\n")])])]),s("p",[t._v("Use the router admin password for login.")]),t._v(" "),s("p",[t._v("In the console type:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("cd /extdisks/sda1 #can be different if you remove and reinsert the USB flash drive\nmtd write openwrt-ramips-mt7621-mir3g-squashfs-kernel1.bin kernel1\nmtd write openwrt-ramips-mt7621-mir3g-squashfs-rootfs0.bin rootfs0\nnvram set flag_try_sys1_failed=1\nnvram commit\nreboot\n")])])]),s("p",[t._v("The router will reboot, once back up the LED will turn into solid blue.")]),t._v(" "),s("h3",{attrs:{id:"install-openwrt-webfrontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-openwrt-webfrontend"}},[t._v("#")]),t._v(" Install OpenWrt Webfrontend")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Installed in 19.07.3 Release")]),t._v(" "),s("p",[t._v("This step is not needed when installing stable only when installing a snapshot.")])]),t._v(" "),s("p",[t._v("The OpenWrt installation will have no WiFi configured so the only way to connect is through the white Ethernet ports of the router.")]),t._v(" "),s("p",[t._v("Reconfigure the interface on the machine connecting to the router to use DHCP. The computer will receive an IP address from the 192.168.1.0/24 range.")]),t._v(" "),s("p",[t._v("Connect to the router through ssh")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ssh -l root 192.168.1.1\n")])])]),s("p",[t._v("On the router issue")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("opkg update\nopkg install luci-ssl\nreboot\n")])])]),s("p",[t._v("The router will reboot, once back up the LED will turn into solid blue and you can connect to the "),s("a",{attrs:{href:"https://192.168.1.1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-frontend"),s("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=a.exports}}]);