(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(t,e,r){t.exports=r.p+"assets/img/get_ssh_cn.b5a7d860.png"},51:function(t,e,r){t.exports=r.p+"assets/img/get_ssh_en.cd9faf85.png"},52:function(t,e,r){t.exports=r.p+"assets/img/85-Screenshot_20180408-113011.9303dd54.png"},53:function(t,e,r){t.exports=r.p+"assets/img/84-Screenshot_20180408-113005.fbe6964e.png"},54:function(t,e,r){t.exports=r.p+"assets/img/83-Screenshot_20180408-112951.b61ded38.png"},55:function(t,e,r){t.exports=r.p+"assets/img/80-select-phone-wifi.d0d40864.png"},56:function(t,e,r){t.exports=r.p+"assets/img/82-sign-in-app.1582f056.png"},57:function(t,e,r){t.exports=r.p+"assets/img/81-open_app.d4dd6583.png"},58:function(t,e,r){t.exports=r.p+"assets/img/7th_screen_en.49f6e484.png"},59:function(t,e,r){t.exports=r.p+"assets/img/7th_screen_cn.02268df8.png"},60:function(t,e,r){t.exports=r.p+"assets/img/6th-screen-cn.df405b60.png"},61:function(t,e,r){t.exports=r.p+"assets/img/6th-screen-en.b8ffca53.png"},62:function(t,e,r){t.exports=r.p+"assets/img/5th-screen-en.96f0245d.png"},63:function(t,e,r){t.exports=r.p+"assets/img/5th-screen-cn.5ba86da9.png"},64:function(t,e,r){t.exports=r.p+"assets/img/4th_screen_cn.4652126a.png"},65:function(t,e,r){t.exports=r.p+"assets/img/3rd_screen_en.454dc84d.png"},66:function(t,e,r){t.exports=r.p+"assets/img/3rd_screen_cn.3d80b558.png"},67:function(t,e,r){t.exports=r.p+"assets/img/2nd_screen_en.55494f81.png"},68:function(t,e,r){t.exports=r.p+"assets/img/2nd_screen_cn.39f86a7b.png"},69:function(t,e,r){t.exports=r.p+"assets/img/1st_screen.e93c62cb.png"},70:function(t,e,r){t.exports=r.p+"assets/img/0-ip-address-client.204d0b31.png"},71:function(t,e,r){t.exports=r.p+"assets/img/connectivity.57abc741.png"},73:function(t,e,r){"use strict";r.r(e);var a=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"openwrt-on-xiaomi-router"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openwrt-on-xiaomi-router","aria-hidden":"true"}},[t._v("#")]),t._v(" OpenWRT on Xiaomi Router")]),a("h2",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[t._v("#")]),t._v(" Introduction")]),a("p",[t._v("Detailed write-up including screen-shots and -grabs based on descriptions from "),a("a",{attrs:{href:"https://forum.lede-project.org/u/dissent1",target:"_blank",rel:"noopener noreferrer"}},[t._v("@dissent")]),t._v(" and the "),a("a",{attrs:{href:"https://wiki.openwrt.org/toh/xiaomi/mir3g",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenWrt wiki")]),t._v(" page for this router.")]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Disclaimer")]),a("p",[t._v("Although the name might imply, this router does not have 3G - or any other 3GPP  standardized - radio")])]),a("h3",{attrs:{id:"naming"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#naming","aria-hidden":"true"}},[t._v("#")]),t._v(" Naming")]),a("p",[t._v("The device's literal name translated from Chinese is "),a("em",[t._v("Xiaomi Router 3G")]),t._v(", with "),a("em",[t._v("Xiaomi")]),t._v(" being the company's name. There might have been earlier intentions to brand the WiFi router product line as "),a("em",[t._v("MiWiFi")]),t._v(" which would explain why Xiaomi is distributing information and firmware updates at "),a("a",{attrs:{href:"miwifi.com"}},[t._v("miwifi.com")]),t._v(".")]),a("h2",{attrs:{id:"preparations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preparations","aria-hidden":"true"}},[t._v("#")]),t._v(" Preparations")]),a("h3",{attrs:{id:"xiaomi-account"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xiaomi-account","aria-hidden":"true"}},[t._v("#")]),t._v(" Xiaomi Account")]),a("p",[t._v("Create a Xiaomi account "),a("a",{attrs:{href:"http://account.xiaomi.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("here")]),t._v(" - this account is required to get the ssh binary and the serial number specific root password")]),a("p",[t._v("OpenWrt/LEDE Project label the router's "),a("a",{attrs:{href:"https://wiki.openwrt.org/toh/xiaomi/mir3g",target:"_blank",rel:"noopener noreferrer"}},[t._v("wiki page")]),t._v(" with "),a("em",[t._v("Xiaomi Mi WiFi R3G (Mi Wifi Router 3G / MIR3G / MI3G)")]),t._v(" and the openwrt software uses the profile name "),a("code",[t._v("mir3g")]),t._v(".")]),a("p",[t._v("Recently Xiaomi has started to distribute one of their router products also in India, where a genuine "),a("a",{attrs:{href:"http://www.mi.com/in/mi-router-3c/",target:"_blank",rel:"noopener noreferrer"}},[t._v("English language page")]),t._v(" calls the specific product Mi Router 3C. Based on that it can be assumed Xiaomi's intention is to use "),a("em",[t._v("Mi Router")]),t._v(" as the international name for the product line, which will be used throughout this document.")]),a("h3",{attrs:{id:"cable-up-for-maximum-convenience"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cable-up-for-maximum-convenience","aria-hidden":"true"}},[t._v("#")]),t._v(" Cable up for maximum convenience")]),a("p",[t._v("The web interface of Mi Router 3G is only available in Chinese. It can be translated by Chrome's inline translation function. To facilitate this the computer running browser needs to stay connected to the internet. To achieve that the router can be connected with Ethernet to that same machine.\n"),a("img",{attrs:{src:r(71),alt:""}})]),a("p",[t._v("On the interface connecting the router:")]),a("ul",[a("li",[t._v("disable DHCP")]),a("li",[t._v("configure static addresse between 192.168.31.2 - 192.168.31.254")]),a("li",[t._v("configure netmask 255.255.255.0")]),a("li",[t._v("no default gateway")])]),a("img",{attrs:{src:r(70),width:"400"}}),a("h2",{attrs:{id:"main-process"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#main-process","aria-hidden":"true"}},[t._v("#")]),t._v(" Main Process")]),a("h3",{attrs:{id:"flash-developer-firmware-on-router"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flash-developer-firmware-on-router","aria-hidden":"true"}},[t._v("#")]),t._v(" Flash Developer Firmware on Router")]),a("p",[t._v("Put the developer firmware for Mi Router 3G from here "),a("a",{attrs:{href:"http://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_c2175_2.25.122.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("miwifi_r3g_firmware_c2175_2.25.122.bin")]),t._v(" on a FAT formatted USB flash drive and rename to "),a("code",[t._v("miwifi.bin")]),t._v(".")]),a("p",[t._v("Plug USB flash drive into router, hold the reset button pressed, and power the router up.")]),a("p",[t._v("When the yellow LED starts blinking, the flashing process has started and the reset button can be released.")]),a("p",[t._v("Once the router has finished flashing and has rebooted, indicated by the LED being constant blue, the setup wizard can be reached at "),a("a",{attrs:{href:"http://192.168.1.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("192.168.31.1")])]),a("h3",{attrs:{id:"router-setup-wizard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#router-setup-wizard","aria-hidden":"true"}},[t._v("#")]),t._v(" Router Setup Wizard")]),a("img",{attrs:{alt:"Initial Splash Screen",src:r(69),width:"400"}}),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(68),alt:"Opt-out from user-experience and continue"}})]),a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(67),alt:"Opt-out from user-experience and continue"}})])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(66),alt:""}})]),a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(65),alt:""}})])]),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(64),alt:""}})]),a("td",{staticStyle:{"text-align":"center"}})]),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(63),alt:""}})]),a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(62),alt:""}})])]),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(61),alt:""}})]),a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(60),alt:""}})])]),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(59),alt:""}})]),a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(58),alt:""}})])])])]),a("h3",{attrs:{id:"pairing-router-with-xiaomi-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pairing-router-with-xiaomi-service","aria-hidden":"true"}},[t._v("#")]),t._v(" Pairing Router with Xiaomi Service")]),a("p",[t._v("This step of the process is run on an Android or iOS device.")]),a("p",[t._v("Install the Mi WiFi app for "),a("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.xiaomi.router&hl=en",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Play Store for Android")]),t._v(" or for "),a("a",{attrs:{href:"https://itunes.apple.com/us/app/mi-wi-fi/id859962702?mt=8",target:"_blank",rel:"noopener noreferrer"}},[t._v("iOS from Apples's App store")])]),a("p",[t._v("Start Up Mi WiFi app and login with the Xiaomi account created earlier:")]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(57),alt:""}})]),a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(56),alt:""}})])])]),a("tbody")]),a("p",[t._v("Connect the device to the just created WiFi network through the system preferences of the mobile phone:")]),a("img",{attrs:{src:r(55),width:"400"}}),a("p",[t._v("After successfully connecting to the new WiFi network return to the Mi WiFi app and finish the pairing process. During the pairing enter the admin password of the router - which should be the same as the WiFi password.")]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(54),alt:""}})]),a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(53),alt:""}})]),a("th",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:r(52),alt:""}})])])]),a("tbody")]),a("p",[t._v("Now the router is paired and connected to the Xiaomi account.")]),a("h3",{attrs:{id:"get-root-password-for-your-router-and-install-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-root-password-for-your-router-and-install-ssh","aria-hidden":"true"}},[t._v("#")]),t._v(" Get root password for your router and install SSH")]),a("p",[t._v("Navigate to "),a("a",{attrs:{href:"https://d.miwifi.com/rom/ssh",target:"_blank",rel:"noopener noreferrer"}},[t._v("Xiaomi MiWiFi support site")]),t._v(" and login with your Xiaomi account.")]),a("p",[a("em",[a("strong",[t._v("In every step the server will rewrite the URL back to '''http://....''' and fail to load the page. Edit the URL in the location bar to read '''https://...'''")])])]),a("p",[a("img",{attrs:{src:r(51),alt:""}}),a("img",{attrs:{src:r(50),alt:""}})]),a("p",[t._v("Click the button to the right and download the ssh installation package "),a("code",[t._v("miwifi_ssh.bin")]),t._v(".")]),a("p",[t._v("Download the OpenWrt firmware files")]),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-mir3g-squashfs-kernel1.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-mir3g-squashfs-kernel1.bin")])])]),a("li",[a("p",[a("a",{attrs:{href:"https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-mir3g-squashfs-rootfs0.bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://downloads.openwrt.org/snapshots/targets/ramips/mt7621/openwrt-ramips-mt7621-mir3g-squashfs-rootfs0.bin")])])])]),a("p",[t._v("Place "),a("code",[t._v("miwifi_ssh.bin")]),t._v(", "),a("code",[t._v("kernel1.bin")]),t._v(" and "),a("code",[t._v("rootfs0.bin")]),t._v(" on the FAT formatted USB flash drive after removing the developer firmware installation file, i.e. the "),a("code",[t._v("miwifi.bin")]),t._v(" from earlier.")]),a("p",[t._v("Plug the USB flash drive into the router, hold the reset button pressed, and power the router up.")]),a("p",[t._v("When the yellow LED starts blinking, the flashing process has started and the reset button can be released. This will install  and ssh daemon to allow remote access through ssh.")]),a("p",[t._v("The router will reboot after installing the ssh package. Once back up the LED will turn into solid blue.")]),a("h3",{attrs:{id:"install-openwrt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-openwrt","aria-hidden":"true"}},[t._v("#")]),t._v(" Install OpenWrt")]),a("p",[t._v("From a terminal connect to the router with SSH:")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ssh -l root 192.168.31.1\n")])]),a("p",[t._v("Use the router admin password for login.")]),a("p",[t._v("In the console type:")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd /extdisks/sda1 #can be different if you remove and reinsert the USB flash drive\nmtd write openwrt-ramips-mt7621-mir3g-squashfs-kernel1.bin kernel1\nmtd write openwrt-ramips-mt7621-mir3g-squashfs-rootfs0.bin rootfs0\nnvram set flag_try_sys1_failed=1\nnvram commit\nreboot\n")])]),a("p",[t._v("The router will reboot, once back up the LED will turn into solid blue.")]),a("h3",{attrs:{id:"install-openwrt-webfrontend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-openwrt-webfrontend","aria-hidden":"true"}},[t._v("#")]),t._v(" Install OpenWrt Webfrontend")]),a("p",[t._v("The OpenWrt installation will have no WiFi configured so the only way to connect is through the white Ethernet ports of the router.")]),a("p",[t._v("Reconfigure the interface on the machine connecting to the router to use DHCP. The computer will receive an IP address from the 192.168.1.0/24 range.")]),a("p",[t._v("Connect to the router through ssh")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ssh -l root 192.168.1.1\n")])]),a("p",[t._v("On the router issue")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("opkg update\nopkg install luci-ssl\nreboot\n")])]),a("p",[t._v("The router will reboot, once back up the LED will turn into solid blue and you can connect to the "),a("a",{attrs:{href:"https://192.168.1.1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-frontend")])])])}],i=r(0),n=Object(i.a)({},function(){this.$createElement;this._self._c;return this._m(0)},a,!1,null,null,null);e.default=n.exports}}]);